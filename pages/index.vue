<template>
    <main
        class="v-index"
    >
        <div
            class="v-index__header"
        >
            <app-header/>
        </div>

        <div
            class="v-index__content app-show-background-on-nav"
        >
            <section
                class="v-index__section"
            >
                <div
                    class="v-index__grid__coll-full"
                >

                    <div
                        class="v-index__section__video_player"
                    >
                        <app-video link="Cl6GSYXWJGR9EyDI"/>
                    </div>
                </div>
            </section>
            <section
                class="v-index__section v-index__section--intro"
            >
                <div
                    class="v-index__grid__coll-full"
                >
                    <p>
                        Le 21e siècle sera marqué par le défi imposé par le changement climatique. En Suisse, le secteur des
                        transports représente aujourd’hui 31% des émissions contre 24% dans le monde. La mobilité constitue donc 30%
                        du problème mais également 30% de la solution. La Fondation Modus a pour vocation de participer à relever le
                        défi de la décarbonation en soutenant les acteurs de Genève pour atteindre l’objectif 0 carbone à
                        l’horizon 2050.
                    </p>
                    <p>
                        La Fondation Modus prend le parti d’agir à l’échelle locale en se positionnant comme un accélérateur du
                        changement et un soutien aux acteurs déjà en place. Ce soutien se matérialise à travers des interventions
                        concrètes sur le territoire et auprès des habitant.e.s du Canton de Genève.
                    </p>
                </div>
            </section>

            <section
                class="v-index__section"
            >
                <div
                    class="v-index__section__content v-index__grid v-index__grid--wrap v-index__grid--with-gutter app-schema_1 app-schema_animation"
                >
                    <img class="app-schema_1_3" alt="icon" src="../assets/schema_1/1-3.svg"/>
                    <img class="app-schema_1_4" alt="icon" src="../assets/schema_1/1-4.svg"/>
                    <img class="app-schema_1_5" alt="icon" src="../assets/schema_1/1-5.svg"/>
                    <img class="app-schema_1_6" alt="icon" src="../assets/schema_1/1-6.svg"/>
                    <img class="app-schema_1_7" alt="icon" src="../assets/schema_1/1-7.svg"/>
                    <img class="app-schema_1_8" alt="icon" src="../assets/schema_1/1-8.svg"/>
                    <img class="app-schema_1_9" alt="icon" src="../assets/schema_1/1-9.svg"/>
                    <img class="app-schema_1_10 is-circle" alt="icon" src="../assets/schema_1/1-10.svg"/>
                    <img class="app-schema_1_0 not-animated" alt="icon" src="../assets/schema_1/1-0.svg"/>
                    <img class="app-schema_1_1 not-animated" alt="icon" src="../assets/schema_1/1-1.svg"/>
                    <img class="app-schema_1_2 not-animated" alt="icon" src="../assets/schema_1/1-2.svg"/>
                    <img class="app-schema_1_11 not-animated" alt="icon" src="../assets/schema_1/1-11.svg"/>
                </div>

                <div
                    class="v-index__section__content v-index__grid v-index__grid--wrap v-index__grid--with-gutter app-schema_2 app-schema_animation"
                >
                    <img class="app-schema_2_0" alt="schema" src="../assets/schema_2/2_0.svg" />
                    <img class="app-schema_2_1" alt="schema" src="../assets/schema_2/2-1.svg" />
                    <img class="app-schema_2_2" alt="schema" src="../assets/schema_2/2-2.svg" />
                    <img class="app-schema_2_3" alt="schema" src="../assets/schema_2/2-3.svg" />
                    <img class="app-schema_2_4" alt="schema" src="../assets/schema_2/2-4.svg" />
                    <img class="app-schema_2_6 is-circle" alt="schema" src="../assets/schema_2/2-6.svg" />
                    <img class="app-schema_2_5 not-animated" alt="schema" src="../assets/schema_2/2-5.svg" />
                </div>
            </section>

            <section
                class="v-index__section"
            >
                <div
                    class="v-index__section__title"
                >
                    <h2>Objectifs</h2>
                </div>

                <div
                    class="v-index__section__content v-index__section__content--sticky v-index__grid v-index__grid--with-gutter"
                >
                    <div
                        class="v-index__grid__coll-1-2"
                    >
                        <ul>
                            <li>Soutenir les acteurs de la mobilité dans leurs projets</li>
                            <li>Stimuler les interconnaissances entre les&nbsp;acteurs</li>
                            <li>Mettre à disposition des approches, des idées et des connaissances nouvelles</li>
                            <li>Proposer de nouveaux imaginaires et valeurs sociales de la&nbsp;mobilité</li>
                            <li>Documenter et disséminer le&nbsp;changement</li>
                        </ul>
                    </div>
                    <div
                        class="v-index__grid__coll-1-2 v-index__section__content--sticky__coll"
                    >
                        <div
                            class="v-index__section__content--sticky__coll__element-sticky"
                        >
                            <img
                                src="/images/compress/116-2.jpg"
                                alt="image de ville abstraite"
                            />
                        </div>
                    </div>
                </div>

            </section>

            <section
                class="v-index__section"
            >
                <div
                    class="v-index__section__title"
                >
                    <h2>Le collectif</h2>
                </div>

                <div
                    class="v-index__section__content v-index__grid v-index__grid--wrap v-index__grid--with-gutter"
                >
                    <div
                        class="v-index__grid__coll-1-4"
                    >
                        <app-image
                            src="photos-profiles/01.png"
                            name="Dr. Guillaume Drevon"
                            status="Directeur"
                        />
                    </div>
                    <div
                        class="v-index__grid__coll-3-4"
                    >
                        <div class="v-index__section__content v-index__grid v-index__grid--wrap v-index__grid--with-gutter" >
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    name="Yves Bersier"
                                    status="Membre"
                                    desc="Membre du Conseil de Fondation"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    src="photos-profiles/02.png"
                                    name="Prof. Yves Delacrétaz"
                                    status="Membre"
                                    desc="Membre du Conseil de Fondation et membre du Conseil Scientifique"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    src="photos-profiles/03.png"
                                    name="Prof. Vincent Kaufmann"
                                    status="Membre"
                                    desc="Vice-président du Conseil de Fondaiton et membre du Conseil Scientifique"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    src="photos-profiles/04.png"
                                    name="Dre. Jenny Leuba"
                                    status="Membre"
                                    desc="Membre du Conseil Scientifique"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    src="photos-profiles/09.png"
                                    name="Marc Maugué"
                                    status="Membre"
                                    desc="Membre du Conseil de Fondation"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    src="photos-profiles/05.png"
                                    name="Dre. Lisa Moussaoui"
                                    status="Membre"
                                    desc="Membre du Conseil Scientifique"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    name="Dr. Emmanuel Ravalet"
                                    status="Membre"
                                    desc="Membre du Conseil Scientifique"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    src="photos-profiles/10.png"
                                    name="Thierry Renaud"
                                    status="Secrétaire"
                                    desc="Membre du Conseil de Fondation"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    name="Patrick Saudan"
                                    status="Président"
                                    desc="Pésident du Conseil de Fondaiton"
                                />
                            </div>
                            <div
                                class="v-index__grid__coll-1-3"
                            >
                                <app-image
                                    src="photos-profiles/06.png"
                                    name="Dr. Jean Simos"
                                    status="Membre"
                                    desc="Membre du Conseil Scientifique"
                                />
                            </div>










                        </div>
                    </div>
                </div>

            </section>
        </div>

        <footer class="v-index__footer">
            <app-newsletter/>
            <img
                    src="/attachments/166.jpg"
                class="v-index__bottom-image"
                alt="image d'architecture urbaine"
            />
        </footer>


        <div
            class="v-index__bottom"
        >
            <img
                alt="logo Modus fin de page"
                src="../assets/logo/logo_with_image.svg"
            />
            <div
                :class="{'with-opacity-1': transformYValue > 92}"
                :style="`transform: translate(0, -${ (100 - transformYValue)}%) scale(${transformYValue / 100}, ${transformYValue / 100})`"
                class="v-index__bottom__mailto"
            ><a href="mailto:info@modus-ge.ch" target="_blank">info@modus-ge.ch</a></div>
        </div>

    </main>
</template>





<script lang="ts" setup>

import AppVideo from "~/components/AppVideo.vue";
import {arrayOfH2TitleIdInCurrentPage} from "~/composable/main";
import {getValueToPercent} from "~/utils/precent";


import {bodyScrollInfo} from "~/composable/main";

const bodyScrollInfoStore = bodyScrollInfo()

const transformYValue: ComputedRef<number> = computed(() => {
    return getValueToPercent(bodyScrollInfoStore.value.top, document.body.scrollHeight - window.innerHeight)
})

const h2TitleIdInCurrentPage = arrayOfH2TitleIdInCurrentPage()

onMounted(() => {
    nextTick(() => {
        h2TitleIdInCurrentPage.value =
            Array.from(document.querySelectorAll('.v-index__section__title h2') )
                .map( (htmlHeadingElement) => {


                    if ( ! htmlHeadingElement.id)
                        htmlHeadingElement.id = encodeURIComponent( htmlHeadingElement.textContent || 'generateID' )

                    return {
                        anchor: htmlHeadingElement.id,
                        name: (htmlHeadingElement as HTMLElement).innerText,
                    }
                })

        interactionWithElementToAnimated()
    })
})

function interactionWithElementToAnimated() {
    const elementsToSetBackgroundNav = document.querySelectorAll('.app-schema_animation')

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {

            console.log(entry.target)

            if (entry.isIntersecting) {
                entry.target.classList.add('is-active')
            } else {
                entry.target.classList.remove('is-active')
            }
        })
    }, {
        rootMargin: `0px 0px ${window.innerHeight / 2 * -1}px 0px`
    })

    elementsToSetBackgroundNav.forEach((value) => {
        observer.observe(value)
    })
}
</script>





<style lang="scss" scoped >
.v-index {
}

.v-index__section {
    box-sizing: border-box;
    padding-left: var(--app-gutter);
    padding-right: var(--app-gutter);
    max-width: 1300px;
    margin-left: auto;
    margin-right: auto;
    padding-top: 2rem;
    padding-bottom: 2rem;

    &.v-index__section--intro {
        max-width: 27.5rem;
        box-sizing: content-box;

        p:nth-child(1n + 1) {
            color: var(--app-color-main);
        }
        p:nth-child(2n + 1) {
            color: var(--app-color-main--dark);
        }
    }
}

.v-index__section__video_player {
    max-width: 25rem;
    margin: auto;
    padding-top: 2rem;
}

.v-index__section__content {
    position: relative;

    > img {
        display: block;
        width: 100%;
    }

    &.v-index__section__content--sticky {
        > * {
            @media (max-width: 900px) {
                width: calc( ( (100% + var(--app-gutter) ) / 5 * 3) - var( --app-gutter ) ) !important;
            }
            @media (max-width: 700px) {
                width: calc( ( (100% + var(--app-gutter) ) / 1) - var( --app-gutter ) ) !important;
            }
        }

        .v-index__section__content--sticky__coll {
            @media (max-width: 900px) {
                width: calc(((100% + var(--app-gutter)) / 5 * 2) - var(--app-gutter)) !important;
            }
            @media (max-width: 700px) {
                display: none;
            }
        }

        .v-index__section__content--sticky__coll__element-sticky {
            position: sticky;
            top: 0;

            > img {
                display: block;
                width: 50vw;

                @media (max-width: 900px) {
                    width: calc(100vw / 5 * 2);
                }
            }
        }
    }
}


.v-index__section__title {
    display: flex;
    flex-direction: column;
    align-items: center;
    > * {
        margin-top: 2rem;
        margin-bottom: 2rem;
    }
}

.v-index__grid {
    display: flex;
    flex-wrap: nowrap;

    &.v-index__grid--with-gutter {
        gap: var(--app-gutter);
    }

    &.v-index__grid--wrap {
        flex-wrap: wrap;
    }

    &.v-index__grid--centred {
        justify-content: center;
    }
}

[class*="v-index__grid__coll"] {
    > *:first-child {
        margin-top: 0 !important;
    }
    > *:last-child {
        margin-top: 0 !important;
    }
}

.v-index__grid__coll-full {
    width: 100%;
}

.v-index__grid__coll-1-2 {
    width: 50%;

    .v-index__grid--with-gutter & {
        width: calc( ( (100% + var(--app-gutter) ) / 2) - var( --app-gutter ) );
    }

    @media (max-width: 900px) {
        width: 75%;

        .v-index__grid--with-gutter & {
            width: calc( ( (100% + var(--app-gutter) ) / 3) - var( --app-gutter ) );
        }
    }

    @media (max-width: 700px) {
        width: 100%;

        .v-index__grid--with-gutter & {
            width: 100%;
        }
    }
}

.v-index__grid__coll-1-4 {
    width: 25%;

    .v-index__grid--with-gutter & {
        width: calc( ( (100% + var(--app-gutter) ) / 4) - var( --app-gutter ) );
    }

    @media (max-width: 1200px) {
        width: calc(100% / 3);

        .v-index__grid--with-gutter & {
            width: calc( ( (100% + var(--app-gutter) ) / 3) - var( --app-gutter ) );
        }
    }

    @media (max-width: 900px) {
        width: 50%;

        .v-index__grid--with-gutter & {
            width: calc( ( (100% + var(--app-gutter) ) / 2) - var( --app-gutter ) );
        }
    }

    @media (max-width: 700px) {
        width: 100%;

        .v-index__grid--with-gutter & {
            width: 100%;
        }
    }
}

.v-index__grid__coll-1-3 {
    width: calc(100% / 3);

    .v-index__grid--with-gutter & {
        width: calc( ( (100% + var(--app-gutter) ) / 3) - var( --app-gutter ) );
    }

    @media (max-width: 900px) {
        width: 50%;

        .v-index__grid--with-gutter & {
            width: calc( ( (100% + var(--app-gutter) ) / 2) - var( --app-gutter ) );
        }
    }


    @media (max-width: 700px) {
        width: 100%;

        .v-index__grid--with-gutter & {
            width: 100%;
        }
    }
}

.v-index__grid__coll-3-4 {
    width: 75%;

    .v-index__grid--with-gutter & {
        width: calc( ( (100% + var(--app-gutter) ) / 4 * 3) - var( --app-gutter ) );
    }

    @media (max-width: 1200px) {
        width: 100%;

        .v-index__grid--with-gutter & {
            width: 100%;
        }
    }
}

.v-index__header {
    background: white;
    z-index: 0;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    position: fixed;
}

.v-index__content {
    background: var(--app-color-grey);
    position: relative;
    z-index: 10;
    width: 100%;
}

.v-index__footer {
    background: white;
    position: relative;
    z-index: 10;
}

.v-index__bottom-image {
    display: block;
    width: 100%;
    height: 100vh;
    position: relative;
    z-index: 10;
    object-fit: cover;
}


.v-index__bottom {
    position: sticky;
    bottom: 0;
    z-index: 1;
    background: white;

    > img {
        padding-top: 2rem;
        padding-bottom: 2rem;
        width: 100%;
        height: auto;
        display: block;
    }
}

.v-index__bottom__mailto {
    margin: auto;
    text-align: center;
    width: 100%;
    max-width: none;
    padding-bottom: 2rem;
    transition: opacity 1s ease-in-out;
    opacity: 0;

    &.with-opacity-1 {
        opacity: 1;
    }

    > a {
        color: var(--app-color-main);
        display: block;
        text-decoration: none;
    }
}


.app-schema_animation {
    > img {
        display: block;
        height: auto;
        position: absolute;
        z-index: 1;


        &:not(.not-animated) {
            transform-origin: center center;
            transition: opacity 0s cubic-bezier(.25, 0, .75, 0), transform 0s cubic-bezier(0, 0, 1, 1);
            transition-duration: .25s;
            transition-delay: .25s;
            opacity: 0;
            transform: translate(0, 10%) scale(.75) rotate(5deg);
        }

        &.is-circle {
            transition: opacity 0s cubic-bezier(.25, 0, .75, 0), transform 0s cubic-bezier(0, 0, 1, 1);
            transition-duration: .25s;
            opacity: 0;
            transform: translate(0, 0) scale(.85) rotate(5deg);
            transition-delay: .5s !important;
        }
    }

    &.is-active > img {
        opacity: 1;
        &:not(.not-animated) {
            transition-duration: .75s;

            $increment: 0.05s;
            @for $i from 1 through 20 {
                &:nth-child(#{$i}n) {
                    transition-delay: #{($i - 1) * $increment};
                }
            }
        }
        &.is-circle {
            transition-duration: .5s;
        }
        transform: translate(0, 0) scale(1) rotate(0);
    }
}

.app-schema_1 {
    max-width: 25rem;
    margin: auto;

    > img {
        display: block;
        height: auto;
        position: absolute;
        z-index: 1;
    }

    .app-schema_1_0 {
        width: 100%;
        position: relative;
        opacity: 0 !important;
        pointer-events: none;
        z-index: -1;
    }

    .app-schema_1_1 {
        top: 92.4%;
        left: 75.1%;
        width: 22.1%;
    }

    .app-schema_1_2 {
        top: 8.3%;
        left: 3.9%;
        width: 8.7%;
    }

    .app-schema_1_3 {
        top: 1.3%;
        left: 57.5%;
        width: 23.3%;
    }

    .app-schema_1_4 {
        top: 33.3%;
        left: 74.5%;
        width: 25.4%;
    }

    .app-schema_1_5 {
        top: 54%;
        left: 62.5%;
        width: 23%;
    }
    .app-schema_1_6 {
        top: 65.3%;
        left: 34.5%;
        width: 25.8%;
    }

    .app-schema_1_7 {
        top: 62.4%;
        left: 0;
        width: 28.3%;
    }

    .app-schema_1_8 {
        top: 21.4%;
        left: 1%;
        width: 23%;
    }
    .app-schema_1_9 {
        top: 0;
        left: 23%;
        width: 23%;
    }

    .app-schema_1_10 {
        z-index: 0;
        top: 8%;
        left: 16%;
        width: 61.7%;
    }

    .app-schema_1_11 {
        z-index: 0;
        top: 41.8%;
        left: 29.5%;
        width: 35%;
    }
}


.app-schema_2 {
    max-width: 25rem;
    margin: auto;
    margin-top: 5rem;

    > img {
        display: block;
        height: auto;
        position: absolute;
        z-index: 1;
    }

    .app-schema_2_0 {
        width: 100%;
        position: relative;
        opacity: 0 !important;
        pointer-events: none;
        z-index: -1;
    }
    .app-schema_2_1 {
        top: 67.5%;
        left: 76.5%;
        width: 23.5%;
    }
    .app-schema_2_2 {
        top: 66.8%;
        left: 24.2%;
        width: 25%;
    }

    .app-schema_2_3 {
        top: 14.8%;
        left: 0.1%;
        width: 35%;
    }

    .app-schema_2_4 {
        top: 0.8%;
        left: 67.5%;
        width: 29.8%;
    }

    .app-schema_2_5 {
        top: 45.4%;
        left: 37.4%;
        width: 36.7%;
    }

    .app-schema_2_6 {
        z-index: 0;
        top: 9.8%;
        left: 23.5%;
        width: 64.4%;
    }

}

</style>
